<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ê²½ë§¤ ì‹œìŠ¤í…œ</title>
</head>
<body>
  <h1>ğŸ® ê²½ë§¤ ìƒí’ˆ: ë‹Œí…ë„ ìŠ¤ìœ„ì¹˜</h1>
  <p>ğŸ’¸ í˜„ì¬ ìµœê³  ì…ì°°ê°€: <span id="price">10000</span>ì›</p>
  <p>ğŸ™‹ í˜„ì¬ ì…ì°°ì: <span id="bidder">ì—†ìŒ</span></p>
  <p>â³ ë‚¨ì€ ì‹œê°„: <span id="time">--:--</span></p>

  <input type="text" id="name" placeholder="ë‹¹ì‹ ì˜ ì´ë¦„ ì…ë ¥">
  <input type="number" id="bidPrice" placeholder="ì…ì°°ê°€ ì…ë ¥">
  <button onclick="sendBid()">ì…ì°°í•˜ê¸°</button>

  <p id="result"></p>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();

    socket.on('update', (data) => {
      document.getElementById('price').textContent = data.price;
      document.getElementById('bidder').textContent = data.bidder;

      let seconds = Math.floor(data.timeLeft / 1000);
      let min = String(Math.floor(seconds / 60)).padStart(2, '0');
      let sec = String(seconds % 60).padStart(2, '0');
      document.getElementById('time').textContent = `${min}:${sec}`;
    });

    socket.on('ended', (data) => {
      document.getElementById('result').textContent = `ğŸ‰ ê²½ë§¤ ì¢…ë£Œ! ë‚™ì°°ì: ${data.winner} / ë‚™ì°°ê°€: ${data.price}ì›`;
    });

    socket.on('error', (msg) => {
      alert(msg);
    });

    function sendBid() {
      const name = document.getElementById('name').value;
      const price = parseInt(document.getElementById('bidPrice').value);

      socket.emit('bid', { name, price });
    }
  </script>
</body>
</html>